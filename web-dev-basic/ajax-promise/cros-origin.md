# 异步请求跨域处理

## 同源策略

> 同源策略：Same Origin Policy

在讨论跨域之前，我们有必要解释下“同源策略”：

同源策略是浏览器的一种安全限制，它限制了从同一个源加载的文档或脚本如何与来自另一个源的资源进行交互，这是一个用于隔离潜在恶意文件的重要安全机制。

我们在前端开发过程中遇到的某些资源，如 DOM、AJAX/Fetch 返回的异步数据及浏览器本地存储的 Cookie、localStorage 等，一般会比较敏感。

想象以下场景，我们登录在线银行，这个站点依赖 Cookie 来保护我们的用户信息：只有正常登录认证过的用户，服务器端会在浏览器中存储一个生成的 Cookie 来标识这个用户，允许正常进行转账操作。而在浏览完这个站点后，我们又访问了一个恶意站点，如果没有同源策略限制，这个恶意网站也可以拿到银行站点存储的 Cookie 并传输给别人，那么在这个 Cookie 过期之前，别人可以把你的银行卡搬空。。

关于 DOM 操作也是一样的，虚假钓鱼网站以 iframe 的方式嵌入了真实网站，我们在访问时可能根本发现不了，如果没有同源策略限制，主页面可以任意操作子页面中 DOM 元素，比如在用户密码输入框上增加了额外的事件监听，同样可以诱导我们暴露个人敏感信息。

而我们经常见到的另一些资源，如 CSS 样式表文件、JS 文件、字体文件、图片等因为不具备敏感信息，所以不受同源策略限制，这些静态资源我们可以依赖 CDN 来部署和分发以提高用户体验：一方面 CDN 节点众多，可以就近响应用户请求；另一方面，浏览器在发起请求的时候会默认带上本域的 Cookie，而请求静态资源时明显不需要 Cookie 保护，每次请求都带 Cookie 增大了网络带宽消耗，我们的 CDN 域一般与我们的站点域不一致，可以规避这个问题。

## 跨域处理



参考链接：

[浏览器跨域方法与基于Fetch的Web请求最佳实践]: https://segmentfault.com/a/1190000006095018
[浏览器的同源策略]: https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy

